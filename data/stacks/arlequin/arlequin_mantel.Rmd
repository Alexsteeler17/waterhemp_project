---
title: "arlequin_mantel"
author: "Alexander Lopez"
date: "8/27/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(ggpubr)
library(dplyr)

rory_theme <- theme_classic(base_size = 18) + 
  theme(axis.title.y=element_text(vjust=1.5), axis.title.x=element_text(vjust=0.2)) + #adjust axis title position
  theme(plot.margin = unit(c(.3,.3,.6,.6), "cm"), line = element_line(size = 1.25)) + #adjust plot margins and line element size
  theme(axis.line.x = element_line(colour = "black"), axis.line.y = element_line(colour = "black")) + #draw x and y axes
  theme(axis.text.x = element_text(margin=unit(c(0.5,0.5,0.5,0.5), "cm")), axis.text.y = element_text(margin=unit(c(0.5,0.5,0.5,0.5), "cm"))) + #put margins around axis labels so that nothing overlaps
  theme(axis.ticks.length =unit(-0.3, "cm")) + # move tickmarks inside the axes
  theme(panel.spacing = unit(2, units = "lines")) + #spread out facets
  theme(strip.background = element_blank()) #remove border from facet labels
```

## **Merced IBD - Pairwise Genetic Vs. Geographic Distances**
```{r}
# Read in data
merced_ibd <- read.csv("C:/Users/Alexander Lopez/Documents/Lab/waterhemp_project/data/stacks/arlequin/mantel_ibd_merced.csv", header = TRUE)
```

```{r, fig.width=8, fig.height=6}
# Plot pairwise genetic vs. geographic distances to visualize IBD
ggplot(data = merced_ibd, mapping = aes(x=Geo, y=Fst)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, formula = y~0+x) + 
  labs(x = "Kilometers") +
  ylab(expression(F["ST"]/(1-F["ST"]))) +
  stat_regline_equation(label.y = 0.225, aes(label = ..eq.label..)) +
  stat_regline_equation(label.y = 0.2, aes(label = ..rr.label..)) +
  ggtitle("Pairwise Genetic Vs. Geographic Distance", subtitle = "Merced") + 
  scale_y_continuous(breaks = seq(0, 0.25, by = 0.05), limits = c(0, 0.25)) +
  rory_theme
```

***

## **Midwest IBD - Pairwise Genetic Vs. Geographic Distances**

```{r}
# Read in Midwest data
midwest_ibd <- read.csv("C:/Users/Alexander Lopez/Documents/Lab/waterhemp_project/data/stacks/arlequin/mantel_ibd_midwest.csv", header = TRUE)
```

```{r, fig.width=8, fig.height=6}
# Plot pairwise genetic vs. geographic distances to visualize IBD
midwest_ibd$ln_km <- log(midwest_ibd$Geo) # create new column computing the natural logarithm (ln) of geo distance

midwest_ibd <- midwest_ibd %>% mutate(ln_km = ifelse(ln_km < 0, 0, ln_km)) # convert -inf values to 0

# Pairwise Genetic vs Geographic distance plot: Midwest
ggplot(data = midwest_ibd, mapping = aes(x=ln_km, y=Fst)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, formula = y~0+x) + 
  labs(x = "Ln(Kilometers)") +
  ylab(expression(F["ST"]/(1-F["ST"]))) +
  stat_regline_equation(label.y = 0.225, aes(label = ..eq.label..)) +
  stat_regline_equation(label.y = 0.2, aes(label = ..rr.label..)) +
  ggtitle("Pairwise Genetic Vs. Geographic Distance", subtitle = "Midwest") +
  scale_x_continuous(breaks = seq(0, 7, by = 1)) +
  scale_y_continuous(breaks = seq(0, 0.3, by = 0.05), limits = c(0, 0.25)) +
  rory_theme
```




